╔══════════════════════════════════════╗
║        🧠 USER SPACE PROGRAM         ║
╚══════════════════════════════════════╝
        │
        ▼
╭──────────────────────────────────────╮             ╭────────────────────────────────────────╮
│ read(fd, buf, size)                  │             │ recv(sock, buf, size)                   │
│ (File on disk)                       │             │ (TCP socket, non-blocking)              │
╰──────────────────────────────────────╯             ╰────────────────────────────────────────╯
        │                                              │
        ▼                                              ▼
╔══════════════════════════════════════╗             ╔════════════════════════════════════════╗
║        🧵 KERNEL SPACE (SYSCALL)      ║             ║          🧵 KERNEL SPACE (SYSCALL)      ║
╚══════════════════════════════════════╝             ╚════════════════════════════════════════╝
        │                                              │
        ▼                                              ▼
╭──────────────────────────────────────╮             ╭────────────────────────────────────────╮
│ VFS layer checks page cache          │             │ Check socket receive buffer             │
│ → if data not found                  │             │ → if data available                     │
│                                      │             │    → return data                        │
│                                      │             │ → else:                                 │
│ ↳ Block syscall and initiate I/O     │             │    - return EAGAIN (if non-blocking)    │
╰──────────────────────────────────────╯             ╰────────────────────────────────────────╯
        │                                              │
        ▼                                              ▼
╔══════════════════════════════════════╗             ╔════════════════════════════════════════╗
║        📦 BLOCK LAYER + DRIVER       ║             ║         🧩 TCP STACK + SOCKET LAYER     ║
╚══════════════════════════════════════╝             ╚════════════════════════════════════════╝
        │                                              │
        ▼                                              ▼
╭──────────────────────────────────────╮             ╭────────────────────────────────────────╮
│ Send command to HDD/SSD controller   │             │ Wait for network packet to arrive       │
│                                      │             │ NIC → interrupt → TCP stack             │
│ → I/O operation                      │             │ → update receive buffer                 │
╰──────────────────────────────────────╯             ╰────────────────────────────────────────╯
        │                                              │
        ▼                                              ▼
╔══════════════════════════════════════╗             ╔════════════════════════════════════════╗
║       🔄 DMA copies data to RAM       ║             ║            📥 NIC + DMA into RAM        ║
╚══════════════════════════════════════╝             ╚════════════════════════════════════════╝
        │                                              │
        ▼                                              ▼
╭──────────────────────────────────────╮             ╭────────────────────────────────────────╮
│ Wake up blocked syscall (read)       │             │ `kevent()` wakes up app when socket     │
│ → copy from kernel to user space     │             │ becomes readable                        │
╰──────────────────────────────────────╯             ╰────────────────────────────────────────╯
        │                                              │
        ▼                                              ▼
╔══════════════════════════════════════╗             ╔════════════════════════════════════════╗
║           ✅ read() returns            ║             ║         ✅ recv() returns data          ║
╚══════════════════════════════════════╝             ╚════════════════════════════════════════╝
